namespace Surugaya.Common.Mapper;

/// <summary>
/// 日文動漫作品名稱轉換服務
/// </summary>
public static class SeriesNameMapper
{
    private static readonly Dictionary<string, string> Mapping = InitializeMapping();

    /// <summary>
    /// 從日文標題取得中文作品名稱
    /// </summary>
    /// <param name="japaneseTitle">包含日文作品名的標題</param>
    /// <returns>對應的中文作品名稱，找不到則回傳空字串</returns>
    public static string GetSeriesName(string japaneseTitle)
    {
        if (string.IsNullOrWhiteSpace(japaneseTitle))
            return string.Empty;

        // 按照鍵的長度從長到短排序（優先匹配更具體的關鍵字）
        var sortedMapping = Mapping.OrderByDescending(x => x.Key.Length);

        foreach (var kvp in sortedMapping)
        {
            if (japaneseTitle.Contains(kvp.Key))
            {
                return kvp.Value;
            }
        }

        return string.Empty;
    }
    

    private static Dictionary<string, string> InitializeMapping()
    {
        return new Dictionary<string, string>
        {
            // Re：ゼロから始める異世界生活
            { "Re：ゼロから始める異世界生活", "Re:從零開始的異世界生活" },
            { "リゼロ", "Re:從零開始的異世界生活" },

            // Summer Pockets
            { "Summer Pockets", "Summer Pockets" },

            // ギルドの受付嬢ですが、残業は嫌なのでボスをソロ討伐しようと思います
            { "ギルドの受付嬢ですが、残業は嫌なのでボスをソロ討伐しようと思います", "雖然是公會的櫃檯小姐，但因為不想加班所以打算獨自討伐迷宮頭目" },
            { "ギルドの受付嬢", "雖然是公會的櫃檯小姐，但因為不想加班所以打算獨自討伐迷宮頭目" },

            // この素晴らしい世界に祝福を！
            { "この素晴らしい世界に祝福を", "為美好的世界獻上祝福！" },
            { "このすば", "為美好的世界獻上祝福！" },

            // ソードアート・オンライン
            { "ソードアート・オンライン", "刀劍神域" },
            { "SAO", "刀劍神域" },

            // ダンジョンに出会いを求めるのは間違っているだろうか
            { "ダンジョンに出会いを求めるのは間違っているだろうか", "在地下城尋求邂逅是否搞錯了什麼" },
            { "ダンまち", "在地下城尋求邂逅是否搞錯了什麼" },

            // デート・ア・ライブ
            { "デート・ア・ライブ", "約會大作戰" },

            // ライザのアトリエ
            { "ライザのアトリエ", "萊莎的鍊金工房" },

            // 五等分の花嫁
            { "五等分の花嫁", "五等分的花嫁" },
            { "五等分の花嫁*", "五等分的花嫁" },

            // 君のことが大大大大大好きな100人の彼女
            { "君のことが大大大大大好きな100人の彼女", "超超超超超喜歡你的100個女朋友" },

            // 女神のカフェテラス
            { "女神のカフェテラス", "女神咖啡廳" },

            // 彼女、お借りします
            { "彼女、お借りします", "出租女友" },

            // 時々ボソッとロシア語でデレる隣のアーリャさん
            { "時々ボソッとロシア語でデレる隣のアーリャさん", "不時輕聲地以俄語遮羞的鄰座艾莉同學" },
            { "アーリャさん", "不時輕聲地以俄語遮羞的鄰座艾莉同學" },

            // 無職転生 ～異世界行ったら本気だす～
            { "無職転生", "無職轉生～到了異世界就拿出真本事～" },

            // 甘城ブリリアントパーク
            { "甘城ブリリアントパーク", "甘城輝煌樂園救世主" },

            // 甘神さんちの縁結び
            { "甘神さんちの縁結び", "結緣甘神神社" },

            // 転生したら第七王子だったので、気ままに魔術を極めます
            { "転生したら第七王子だったので、気ままに魔術を極めます", "轉生為第七王子，隨心所欲的魔法學習之路" },
            { "転生したら第七王子", "轉生為第七王子，隨心所欲的魔法學習之路" },

            // 負けヒロインが多すぎる！
            { "負けヒロインが多すぎる", "敗犬女主太多了！" },

            // 青春ブタ野郎シリーズ
            { "青春ブタ野郎", "青春豬頭少年" },

            // その着せ替え人形は恋をする
            { "その着せ替え人形は恋をする", "戀上換裝娃娃" },

            // やはり俺の青春ラブコメはまちがっている。
            { "やはり俺の青春ラブコメはまちがっている", "果然我的青春戀愛喜劇搞錯了" },
            { "俺ガイル", "果然我的青春戀愛喜劇搞錯了" },
            { "俺の青春", "果然我的青春戀愛喜劇搞錯了" },

            // 冴えない彼女の育てかた
            { "冴えない彼女の育てかた", "不起眼女主角培育法" },
            { "冴えカノ", "不起眼女主角培育法" }
        };
    }
}